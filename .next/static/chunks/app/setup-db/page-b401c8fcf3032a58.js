(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1872],{5226:function(e,a,t){Promise.resolve().then(t.bind(t,8309))},6151:function(e,a,t){"use strict";t.d(a,{O:function(){return l}});var i=t(6580);let n="https://ilxfqrxybtcftioizoan.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlseGZxcnh5YnRjZnRpb2l6b2FuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NTg5MjMsImV4cCI6MjA2OTQzNDkyM30.Jhjy7136xlqHcVjeCGPDvh4Ofpio3a09Y2fFu2Sqqh0";n||console.warn("Supabase URL not configured properly. Using fallback configuration."),r||console.warn("Supabase Anon Key not configured properly. Using fallback configuration.");let l=(0,i.eI)(n||"https://placeholder.supabase.co",r||"placeholder-key")},8309:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return l}});var i=t(7437),n=t(2265),r=t(6151);function l(){let[e,a]=(0,n.useState)(""),[t,l]=(0,n.useState)(!1),s=async()=>{l(!0),a("Starting database setup...\n");try{a(e=>e+"Creating update function...\n"),await r.O.rpc("exec_sql",{sql:"\n          CREATE OR REPLACE FUNCTION update_updated_at_column()\n          RETURNS TRIGGER AS $$\n          BEGIN\n              NEW.updated_at = NOW();\n              RETURN NEW;\n          END;\n          $$ language 'plpgsql';\n        "}),a(e=>e+"Creating gallery_categories table...\n");let{error:e}=await r.O.rpc("exec_sql",{sql:"\n          CREATE TABLE IF NOT EXISTS gallery_categories (\n              id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n              name TEXT NOT NULL UNIQUE,\n              description TEXT,\n              slug TEXT NOT NULL UNIQUE,\n              display_order INTEGER DEFAULT 0,\n              is_active BOOLEAN DEFAULT true,\n              created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n              updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n          );\n        "});if(e)throw Error("Categories table error: ".concat(e.message));a(e=>e+"Creating categories trigger...\n"),await r.O.rpc("exec_sql",{sql:"\n          DROP TRIGGER IF EXISTS update_gallery_categories_updated_at ON gallery_categories;\n          CREATE TRIGGER update_gallery_categories_updated_at \n              BEFORE UPDATE ON gallery_categories \n              FOR EACH ROW \n              EXECUTE FUNCTION update_updated_at_column();\n        "}),a(e=>e+"Inserting categories...\n");let{error:t}=await r.O.from("gallery_categories").upsert([{name:"Installations",description:"Industrial compressor installations and setup",slug:"installations",display_order:1},{name:"Maintenance",description:"Maintenance workshops and service operations",slug:"maintenance",display_order:2},{name:"Testing",description:"Quality testing processes and procedures",slug:"testing",display_order:3},{name:"Facilities",description:"Our manufacturing facilities and equipment",slug:"facilities",display_order:4},{name:"Training",description:"Training sessions and educational programs",slug:"training",display_order:5}],{onConflict:"slug"});if(t)throw Error("Insert categories error: ".concat(t.message));a(e=>e+"Creating gallery_images table...\n");let{error:i}=await r.O.rpc("exec_sql",{sql:"\n          CREATE TABLE IF NOT EXISTS gallery_images (\n              id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n              title TEXT NOT NULL,\n              url TEXT NOT NULL,\n              category TEXT,\n              category_id UUID REFERENCES gallery_categories(id) ON DELETE SET NULL,\n              created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n              updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n          );\n        "});if(i)throw Error("Images table error: ".concat(i.message));a(e=>e+"Creating images trigger...\n"),await r.O.rpc("exec_sql",{sql:"\n          DROP TRIGGER IF EXISTS update_gallery_images_updated_at ON gallery_images;\n          CREATE TRIGGER update_gallery_images_updated_at \n              BEFORE UPDATE ON gallery_images \n              FOR EACH ROW \n              EXECUTE FUNCTION update_updated_at_column();\n        "}),a(e=>e+"Getting category IDs...\n");let{data:n}=await r.O.from("gallery_categories").select("id, slug"),l=(null==n?void 0:n.reduce((e,a)=>(e[a.slug]=a.id,e),{}))||{};a(e=>e+"Inserting images...\n");let s=[{title:"Industrial Compressor Installation",url:"/img/gallery/4big.jpg",category:"installations",category_id:l.installations},{title:"Maintenance Workshop",url:"/img/gallery/11big.jpg",category:"maintenance",category_id:l.maintenance},{title:"Quality Testing Process",url:"/img/gallery/12big.jpg",category:"testing",category_id:l.testing},{title:"Advanced Manufacturing Facility",url:"/img/gallery/Al Ahmadeya.jpg",category:"facilities",category_id:l.facilities},{title:"Training Session",url:"/img/gallery/Al Ahram.jpg",category:"training",category_id:l.training},{title:"Manufacturing Facility Equipment",url:"/img/gallery/Al_Ahmadeya.jpg",category:"facilities",category_id:l.facilities},{title:"Advanced Installation Project",url:"/img/gallery/Alamia Advanced.jpg",category:"installations",category_id:l.installations},{title:"Industrial Installation - Qaliub",url:"/img/gallery/Alamia Qaliub.jpg",category:"installations",category_id:l.installations},{title:"Maintenance Operations",url:"/img/gallery/maintenence.jpg",category:"maintenance",category_id:l.maintenance},{title:"Egyptian Methanex Testing",url:"/img/gallery/Egyptian Methanex.jpg",category:"testing",category_id:l.testing},{title:"Installation Documentation",url:"/img/gallery/DSC00502.jpg",category:"installations",category_id:l.installations},{title:"Best Analog Compressor Facility",url:"/img/gallery/BEST_ANALOG_COMPRESSOR_BG.jpg",category:"facilities",category_id:l.facilities},{title:"Alex Pharma Installation",url:"/img/gallery/Alex Pharma.jpg",category:"installations",category_id:l.installations},{title:"Danone Egypt Testing",url:"/img/gallery/Danone Egypt.jpg",category:"testing",category_id:l.testing},{title:"EgyRoll Maintenance",url:"/img/gallery/EgyRoll.jpg",category:"maintenance",category_id:l.maintenance},{title:"Training Documentation",url:"/img/gallery/IMG_4019.jpg",category:"training",category_id:l.training}],{error:g}=await r.O.from("gallery_images").upsert(s,{onConflict:"url"});if(g)throw Error("Insert images error: ".concat(g.message));a(e=>e+"✅ Database setup completed successfully!\n"),a(e=>e+"You can now go to /gallery to see the images from database.\n")}catch(e){console.error("Setup error:",e),a(a=>a+"❌ Error: ".concat(e.message,"\n"))}finally{l(!1)}};return(0,i.jsxs)("div",{className:"p-8",children:[(0,i.jsx)("h1",{className:"text-2xl mb-4",children:"Database Setup"}),(0,i.jsx)("p",{className:"mb-4 text-gray-600",children:"This will create the necessary tables and insert sample data for the gallery."}),(0,i.jsx)("button",{onClick:s,disabled:t,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:opacity-50 mb-4",children:t?"Setting up...":"Setup Database"}),e&&(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded",children:[(0,i.jsx)("h2",{className:"text-lg mb-2",children:"Setup Status:"}),(0,i.jsx)("pre",{className:"whitespace-pre-wrap text-sm",children:e})]})]})}}},function(e){e.O(0,[6580,2971,2117,1744],function(){return e(e.s=5226)}),_N_E=e.O()}]);