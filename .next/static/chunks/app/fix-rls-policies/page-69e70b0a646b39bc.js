(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[380],{16168:function(e,s,n){Promise.resolve().then(n.bind(n,12933))},12933:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return r}});var i=n(57437),l=n(2265);function r(){let[e,s]=(0,l.useState)("");return(0,i.jsxs)("div",{className:"p-8",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"\uD83D\uDD12 Fix RLS Policies for Forms"}),(0,i.jsxs)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"⚠️ Row Level Security (RLS) Issues"}),(0,i.jsx)("p",{className:"text-yellow-700 mb-2",children:"Form submission errors are often caused by Row Level Security policies blocking database operations."}),(0,i.jsxs)("div",{className:"text-sm text-yellow-600",children:[(0,i.jsx)("strong",{children:"Common symptoms:"}),(0,i.jsxs)("ul",{className:"mt-1 space-y-1",children:[(0,i.jsx)("li",{children:'• "new row violates row-level security policy" error'}),(0,i.jsx)("li",{children:"• Forms submit but data doesn't save"}),(0,i.jsx)("li",{children:'• "permission denied" errors in console'}),(0,i.jsx)("li",{children:"• Empty tables even after successful submissions"})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,i.jsxs)("button",{onClick:()=>{s('\n-- \uD83D\uDD27 SQL Commands to Fix RLS Policies for Forms\n-- Run these commands in your Supabase SQL Editor\n\n-- 1. Disable RLS temporarily for testing (OPTIONAL)\nALTER TABLE applications DISABLE ROW LEVEL SECURITY;\nALTER TABLE services DISABLE ROW LEVEL SECURITY;\nALTER TABLE product_categories DISABLE ROW LEVEL SECURITY;\n\n-- 2. OR Create proper RLS policies for public access\n\n-- Applications table policies\nCREATE POLICY "Enable read access for all users" ON applications\nFOR SELECT USING (true);\n\nCREATE POLICY "Enable insert access for all users" ON applications\nFOR INSERT WITH CHECK (true);\n\nCREATE POLICY "Enable update access for all users" ON applications\nFOR UPDATE USING (true);\n\nCREATE POLICY "Enable delete access for all users" ON applications\nFOR DELETE USING (true);\n\n-- Services table policies\nCREATE POLICY "Enable read access for all users" ON services\nFOR SELECT USING (true);\n\nCREATE POLICY "Enable insert access for all users" ON services\nFOR INSERT WITH CHECK (true);\n\nCREATE POLICY "Enable update access for all users" ON services\nFOR UPDATE USING (true);\n\nCREATE POLICY "Enable delete access for all users" ON services\nFOR DELETE USING (true);\n\n-- Product categories table policies\nCREATE POLICY "Enable read access for all users" ON product_categories\nFOR SELECT USING (true);\n\nCREATE POLICY "Enable insert access for all users" ON product_categories\nFOR INSERT WITH CHECK (true);\n\nCREATE POLICY "Enable update access for all users" ON product_categories\nFOR UPDATE USING (true);\n\nCREATE POLICY "Enable delete access for all users" ON product_categories\nFOR DELETE USING (true);\n\n-- 3. Check if policies exist\nSELECT schemaname, tablename, policyname, permissive, roles, cmd, qual \nFROM pg_policies \nWHERE tablename IN (\'applications\', \'services\', \'product_categories\');\n\n-- 4. Drop existing policies if needed (run only if you want to recreate them)\n-- DROP POLICY IF EXISTS "Enable read access for all users" ON applications;\n-- DROP POLICY IF EXISTS "Enable insert access for all users" ON applications;\n-- DROP POLICY IF EXISTS "Enable update access for all users" ON applications;\n-- DROP POLICY IF EXISTS "Enable delete access for all users" ON applications;\n\n-- 5. Alternative: Create more restrictive policies (for production)\n-- CREATE POLICY "Enable insert for authenticated users only" ON applications\n-- FOR INSERT TO authenticated WITH CHECK (true);\n\n-- CREATE POLICY "Enable update for authenticated users only" ON applications\n-- FOR UPDATE TO authenticated USING (true);\n')},className:"bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700 text-left",children:[(0,i.jsx)("div",{className:"font-semibold mb-1",children:"\uD83D\uDCDD Show SQL Commands"}),(0,i.jsx)("div",{className:"text-sm opacity-90",children:"Get SQL commands to fix RLS policies"})]}),(0,i.jsxs)("button",{onClick:()=>{s('\n\uD83D\uDD0D TROUBLESHOOTING STEPS FOR FORM ERRORS\n\n1. \uD83D\uDCCA CHECK SUPABASE DASHBOARD\n   • Go to your Supabase project dashboard\n   • Navigate to Authentication > Policies\n   • Check if RLS is enabled on applications/services tables\n   • Look for any restrictive policies\n\n2. \uD83D\uDD27 COMMON RLS ISSUES\n   • RLS enabled but no policies = All operations blocked\n   • Policies exist but don\'t match your use case\n   • Authentication required but user not logged in\n   • Wrong policy conditions\n\n3. \uD83D\uDE80 QUICK FIXES\n   Option A: Disable RLS (for development only)\n   • Go to Database > Tables\n   • Click on table name\n   • Toggle "Enable RLS" to OFF\n\n   Option B: Create permissive policies\n   • Use the SQL commands provided above\n   • Run them in SQL Editor\n\n4. \uD83E\uDDEA TEST AFTER CHANGES\n   • Try adding a new application/service\n   • Check browser console for errors\n   • Use /diagnose-forms to verify fixes\n\n5. \uD83D\uDCDD FORM-SPECIFIC CHECKS\n   • Ensure all required fields are filled\n   • Check that array fields (use_cases, benefits, features) are properly formatted\n   • Verify image_url is a valid URL format\n   • Make sure display_order is a positive number\n\n6. \uD83D\uDD0D BROWSER CONSOLE ERRORS\n   Common error messages and solutions:\n   \n   "new row violates row-level security policy"\n   → RLS is blocking the insert, fix policies\n   \n   "null value in column violates not-null constraint"\n   → Required field is missing, check form validation\n   \n   "invalid input syntax for type json"\n   → Array field formatting issue, check data structure\n   \n   "permission denied for table"\n   → Database permissions issue, check Supabase settings\n\n7. \uD83D\uDEE0️ DEVELOPMENT VS PRODUCTION\n   Development: Disable RLS or use permissive policies\n   Production: Use proper authentication-based policies\n')},className:"bg-green-600 text-white px-6 py-4 rounded-lg hover:bg-green-700 text-left",children:[(0,i.jsx)("div",{className:"font-semibold mb-1",children:"\uD83D\uDD0D Troubleshooting Guide"}),(0,i.jsx)("div",{className:"text-sm opacity-90",children:"Step-by-step problem solving"})]})]}),e&&(0,i.jsxs)("div",{className:"bg-gray-900 text-green-400 p-6 rounded-lg font-mono text-sm",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h2",{className:"text-lg text-white",children:"\uD83D\uDCCB Instructions:"}),(0,i.jsx)("button",{onClick:()=>navigator.clipboard.writeText(e),className:"bg-gray-700 text-white px-3 py-1 rounded text-xs hover:bg-gray-600",children:"\uD83D\uDCCB Copy"})]}),(0,i.jsx)("pre",{className:"whitespace-pre-wrap max-h-96 overflow-y-auto",children:e})]}),(0,i.jsxs)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,i.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,i.jsx)("h3",{className:"font-semibold text-red-800 mb-2",children:"\uD83D\uDEA8 Quick Fix (Development)"}),(0,i.jsxs)("div",{className:"text-sm text-red-700 space-y-2",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Fastest solution:"})}),(0,i.jsxs)("ol",{className:"space-y-1",children:[(0,i.jsx)("li",{children:"1. Go to Supabase Dashboard"}),(0,i.jsx)("li",{children:"2. Database → Tables"}),(0,i.jsx)("li",{children:"3. Click table name"}),(0,i.jsx)("li",{children:'4. Toggle "Enable RLS" OFF'}),(0,i.jsx)("li",{children:"5. Test forms again"})]}),(0,i.jsx)("p",{className:"text-xs mt-2 opacity-75",children:"⚠️ Only for development!"})]})]}),(0,i.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,i.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDD27 Proper Fix (Recommended)"}),(0,i.jsxs)("div",{className:"text-sm text-blue-700 space-y-2",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Create proper policies:"})}),(0,i.jsxs)("ol",{className:"space-y-1",children:[(0,i.jsx)("li",{children:"1. Use SQL commands provided"}),(0,i.jsx)("li",{children:"2. Run in Supabase SQL Editor"}),(0,i.jsx)("li",{children:"3. Create permissive policies"}),(0,i.jsx)("li",{children:"4. Test form submissions"}),(0,i.jsx)("li",{children:"5. Adjust policies as needed"})]}),(0,i.jsx)("p",{className:"text-xs mt-2 opacity-75",children:"✅ Safe for production"})]})]}),(0,i.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,i.jsx)("h3",{className:"font-semibold text-green-800 mb-2",children:"\uD83E\uDDEA Testing Steps"}),(0,i.jsxs)("div",{className:"text-sm text-green-700 space-y-2",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"After applying fixes:"})}),(0,i.jsxs)("ol",{className:"space-y-1",children:[(0,i.jsx)("li",{children:"1. Run /diagnose-forms"}),(0,i.jsx)("li",{children:"2. Test /admin/applications/new"}),(0,i.jsx)("li",{children:"3. Test /admin/services/new"}),(0,i.jsx)("li",{children:"4. Check browser console"}),(0,i.jsx)("li",{children:"5. Verify data in Supabase"})]}),(0,i.jsx)("p",{className:"text-xs mt-2 opacity-75",children:"\uD83C\uDFAF Confirm everything works"})]})]})]}),(0,i.jsxs)("div",{className:"mt-6 bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,i.jsx)("h3",{className:"font-semibold text-purple-800 mb-2",children:"\uD83C\uDFAF Expected Outcome"}),(0,i.jsxs)("div",{className:"text-sm text-purple-700",children:[(0,i.jsx)("p",{className:"mb-2",children:"After applying the fixes, you should be able to:"}),(0,i.jsxs)("ul",{className:"space-y-1",children:[(0,i.jsx)("li",{children:"• ✅ Add new applications without errors"}),(0,i.jsx)("li",{children:"• ✅ Edit existing applications successfully"}),(0,i.jsx)("li",{children:"• ✅ Add new services without errors"}),(0,i.jsx)("li",{children:"• ✅ Edit existing services successfully"}),(0,i.jsx)("li",{children:"• ✅ See data immediately in admin lists"}),(0,i.jsx)("li",{children:"• ✅ No console errors during form submission"})]})]})]})]})}}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=16168)}),_N_E=e.O()}]);