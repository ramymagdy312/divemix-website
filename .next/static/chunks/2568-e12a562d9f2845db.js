"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2568],{4501:function(e,t,r){var s=r(7437),a=r(2265),o=r(6475),l=r(7168),n=r(2660),i=r(407),c=r(9637),d=r(9397),u=r(7689),m=r(401),h=r(2489),g=r(5863),p=r(4924),x=r(8930),f=r(3113),b=r(3145),y=r(9064);t.Z=e=>{let{image:t,onImageChange:r,label:j="Image"}=e,[v,N]=(0,a.useState)("root"),[w,C]=(0,a.useState)([]),[Z,k]=(0,a.useState)([]),[D,I]=(0,a.useState)(!1),[P,E]=(0,a.useState)(!1),[F,S]=(0,a.useState)(!1),[T,O]=(0,a.useState)(""),[R,J]=(0,a.useState)(["root"]),U=(0,a.useRef)(null),z=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;I(!0);try{let r="root"===e?"/api/upload/folders":"/api/upload/folders?path=".concat(encodeURIComponent(e)),s=await fetch(r);if(s.ok){let e=await s.json();C(e.folders||[])}let a="root"===e?"/api/upload/list":"/api/upload/list?folder=".concat(encodeURIComponent(e)),o=await fetch(a);if(o.ok){var t;let e=await o.json(),r=(null===(t=e.images)||void 0===t?void 0:t.map(e=>e.url))||[];k(r)}}catch(e){console.error("Error loading path:",e),y.ZP.error("Failed to load folder contents")}finally{I(!1)}};(0,a.useEffect)(()=>{z()},[v]);let B=e=>{N(e),J(t=>[...t,e])},L=(e,t)=>{N(e),J(e=>e.slice(0,t+1))},A=async()=>{if(!T.trim()){y.ZP.error("Please enter a folder name");return}I(!0);try{let e=await fetch("/api/upload/folders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderName:T.trim(),parentPath:"root"===v?void 0:v})});if(e.ok)O(""),S(!1),y.ZP.success("Folder created successfully"),z();else{let t=await e.json();y.ZP.error(t.error||"Failed to create folder")}}catch(e){console.error("Error creating folder:",e),y.ZP.error("Failed to create folder")}finally{I(!1)}},M=async(e,t)=>{t.stopPropagation();let r=e.name;if(confirm('⚠️ Delete folder "'.concat(r,'"?\n\nThis will delete the folder and ALL contents including:\n- All images in this folder\n- All subfolders and their contents\n\nThis action cannot be undone.\n\nClick OK to confirm deletion.'))){I(!0),console.log("Deleting folder:",e.fullPath);try{let t=await fetch("/api/upload/folders?path=".concat(encodeURIComponent(e.fullPath)),{method:"DELETE"});if(console.log("Delete response status:",t.status),t.ok){let e=await t.json();console.log("Delete result:",e),y.ZP.success('Folder "'.concat(r,'" deleted successfully')),z()}else{let e=await t.json();console.error("Delete error response:",e),y.ZP.error(e.error||"Failed to delete folder")}}catch(e){console.error("Error deleting folder:",e),y.ZP.error("Network error: Failed to delete folder")}finally{I(!1)}}},q=async(e,s)=>{s.stopPropagation();let a=e.split("/").pop()||"image";if(confirm('⚠️ Delete image "'.concat(a,'"?\n\nThis action cannot be undone.\n\nClick OK to confirm deletion.'))){I(!0);try{let s=await fetch("/api/upload/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e})});if(s.ok)t===e&&r(""),y.ZP.success("Image deleted successfully"),z();else{let e=await s.json();y.ZP.error(e.error||"Failed to delete image")}}catch(e){console.error("Error deleting image:",e),y.ZP.error("Failed to delete image")}finally{I(!1)}}},K=async e=>{if(!e||0===e.length)return;let t=e[0];if(!t.type.startsWith("image/")||t.size>5242880){y.ZP.error("Please select a valid image file (less than 5MB)");return}E(!0);try{let e=new FormData;e.append("file",t),e.append("folder",v);let s=await fetch("/api/upload",{method:"POST",body:e});if(!s.ok)throw Error("Upload failed");let a=await s.json();r(a.url);let o="root"===v?"root folder":v;y.ZP.success("Image uploaded successfully to ".concat(o)),z()}catch(e){console.error("Error uploading image:",e),y.ZP.error("Error occurred while uploading image")}finally{E(!1)}},V=e=>{r(e)},Y=()=>R.map((e,t)=>({name:"root"===e?"Home":e.split("/").pop()||e,path:e,index:t}));return(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-4 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,s.jsx)(o.Z,{className:"h-5 w-5 mr-2 text-green-600"}),"\uD83D\uDDBC️ ",j," Explorer"]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)("button",{type:"button",onClick:()=>z(),disabled:D,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg transition-colors",title:"Refresh",children:(0,s.jsx)(l.Z,{className:"h-4 w-4 ".concat(D?"animate-spin":"")})})})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{if(R.length>1){let e=[...R];e.pop();let t=e[e.length-1];J(e),N(t)}},disabled:R.length<=1,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Back",children:(0,s.jsx)(n.Z,{className:"h-4 w-4"})}),(0,s.jsx)("div",{className:"flex items-center space-x-1 bg-white rounded-lg px-3 py-2 border flex-1",children:Y().map((e,t)=>(0,s.jsxs)(a.Fragment,{children:[t>0&&(0,s.jsx)(i.Z,{className:"h-3 w-3 text-gray-400"}),(0,s.jsx)("button",{type:"button",onClick:()=>L(e.path,e.index),className:"text-sm px-2 py-1 rounded hover:bg-gray-100 transition-colors ".concat(t===Y().length-1?"text-green-600 font-medium":"text-gray-600 hover:text-gray-800"),children:0===t?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),e.name]}):e.name})]},e.path))})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>S(!0),disabled:D,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm disabled:opacity-50",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"New Folder"]}),(0,s.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.click()},disabled:P,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm disabled:opacity-50",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),P?"Uploading...":"Upload Image"]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["\uD83D\uDCC2 ","root"===v?"Root Folder":v," •",w.length," folder(s) • ",Z.length," image(s)"]})]}),F&&(0,s.jsxs)("div",{className:"mt-3 p-3 bg-white rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"text",value:T,onChange:e=>O(e.target.value),placeholder:"Enter folder name...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 text-sm",onKeyPress:e=>"Enter"===e.key&&A(),autoFocus:!0}),(0,s.jsx)("button",{type:"button",onClick:A,disabled:D||!T.trim(),className:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50",children:(0,s.jsx)(m.Z,{className:"h-4 w-4"})}),(0,s.jsx)("button",{type:"button",onClick:()=>{S(!1),O("")},className:"px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:(0,s.jsx)(h.Z,{className:"h-4 w-4"})})]}),(0,s.jsxs)("p",{className:"text-xs text-green-600 mt-2",children:["\uD83D\uDCA1 Creating folder in: ","root"===v?"Root":v]})]})]}),(0,s.jsx)("div",{className:"p-4",children:D?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(g.Z,{className:"h-8 w-8 animate-spin text-green-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Loading folder contents..."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[w.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[(0,s.jsx)(p.Z,{className:"h-4 w-4 mr-2 text-blue-500"}),"\uD83D\uDCC1 Folders (",w.length,")"]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-3",children:w.map(e=>(0,s.jsxs)("div",{className:"group relative bg-gray-50 hover:bg-blue-50 rounded-lg p-3 cursor-pointer transition-colors border border-gray-200 hover:border-blue-300",children:[(0,s.jsxs)("div",{onClick:()=>B(e.fullPath),className:"text-center",children:[(0,s.jsx)(p.Z,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"supabase"===e.source?"☁️ Cloud":"\uD83D\uDCBB Local"})]}),(0,s.jsx)("button",{type:"button",onClick:t=>M(e,t),className:"absolute top-2 right-2 p-2 bg-red-500 text-white hover:bg-red-600 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-lg hover:shadow-xl",title:"Delete folder",disabled:D,children:(0,s.jsx)(x.Z,{className:"h-4 w-4"})})]},e.fullPath))})]}),Z.length>0?(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 mr-2 text-green-500"}),"\uD83D\uDDBC️ Images (",Z.length,")"]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:Z.map((e,r)=>{let a=t===e;return(0,s.jsxs)("div",{onClick:()=>V(e),className:"relative group cursor-pointer rounded-lg overflow-hidden border-2 transition-all duration-200 ".concat(a?"border-green-500 ring-2 ring-green-200 shadow-lg":"border-gray-200 hover:border-green-500 hover:shadow-md"),children:[(0,s.jsxs)("div",{className:"aspect-square relative bg-gray-100",children:[(0,s.jsx)(b.default,{src:e,alt:"Image ".concat(r+1),fill:!0,className:"object-cover"}),a&&(0,s.jsx)("div",{className:"absolute inset-0 bg-green-500 bg-opacity-20 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-green-500 text-white rounded-full p-1",children:(0,s.jsx)(m.Z,{className:"h-4 w-4"})})}),(0,s.jsx)("button",{type:"button",onClick:t=>q(e,t),className:"absolute top-2 right-2 p-2 bg-red-500 text-white hover:bg-red-600 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-lg hover:shadow-xl",title:"Delete image",disabled:D,children:(0,s.jsx)(x.Z,{className:"h-3 w-3"})})]}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 text-white p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("p",{className:"text-xs truncate",children:e.split("/").pop()})})]},r)})})]}):0===w.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(o.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 mb-2",children:"This folder is empty"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Create folders or upload images to get started"})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(f.Z,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No images in this folder"})]})]})}),t&&(0,s.jsx)("div",{className:"border-t bg-gray-50 p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 text-green-600 mr-2"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Image selected: ",t.split("/").pop()]})]}),(0,s.jsx)("button",{type:"button",onClick:()=>r(""),className:"text-sm text-red-600 hover:text-red-800 underline",children:"Clear Selection"})]})}),(0,s.jsx)("input",{ref:U,type:"file",accept:"image/*",onChange:e=>K(e.target.files),className:"hidden"})]})}},2595:function(e,t,r){r.d(t,{d:function(){return i},z:function(){return c}});var s=r(7437),a=r(2265),o=r(7053),l=r(535),n=r(2835);let i=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,s.jsx)(u,{className:(0,n.cn)(i({variant:a,size:l,className:r})),ref:t,...d})});c.displayName="Button"},6151:function(e,t,r){r.d(t,{O:function(){return l},e:function(){return n}});var s=r(6580);let a="https://ilxfqrxybtcftioizoan.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlseGZxcnh5YnRjZnRpb2l6b2FuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NTg5MjMsImV4cCI6MjA2OTQzNDkyM30.Jhjy7136xlqHcVjeCGPDvh4Ofpio3a09Y2fFu2Sqqh0";a||console.warn("Supabase URL not configured properly. Using fallback configuration."),o||console.warn("Supabase Anon Key not configured properly. Using fallback configuration.");let l=(0,s.eI)(a||"https://placeholder.supabase.co",o||"placeholder-key"),n=()=>(0,s.eI)(a||"https://placeholder.supabase.co",o||"placeholder-key")},2835:function(e,t,r){r.d(t,{cn:function(){return o}});var s=r(1994),a=r(3335);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}}}]);