"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8253],{78253:function(e,t,r){var a=r(57437),l=r(2265),s=r(56475),o=r(82431),n=r(32660),i=r(10407),c=r(99637),d=r(99397),h=r(17689),u=r(30401),m=r(32489),x=r(15863),p=r(14924),g=r(18930),f=r(53113),y=r(33145),b=r(69064);t.Z=e=>{let{images:t,onImagesChange:r,multiple:j=!0,maxImages:v=10,label:N="Images"}=e,[w,Z]=(0,l.useState)("root"),[k,C]=(0,l.useState)([]),[P,D]=(0,l.useState)([]),[E,M]=(0,l.useState)(!1),[F,S]=(0,l.useState)(!1),[L,H]=(0,l.useState)(!1),[T,I]=(0,l.useState)(""),[R,A]=(0,l.useState)(["root"]),O=(0,l.useRef)(null),U=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w;M(!0);try{let r="root"===e?"/api/upload/folders":"/api/upload/folders?path=".concat(encodeURIComponent(e)),a=await fetch(r);if(a.ok){let e=await a.json();C(e.folders||[])}let l="root"===e?"/api/upload/list":"/api/upload/list?folder=".concat(encodeURIComponent(e)),s=await fetch(l);if(s.ok){var t;let e=await s.json(),r=(null===(t=e.images)||void 0===t?void 0:t.map(e=>e.url))||[];D(r)}}catch(e){console.error("Error loading path:",e),b.ZP.error("Failed to load folder contents")}finally{M(!1)}};(0,l.useEffect)(()=>{U()},[w]);let B=e=>{Z(e),A(t=>[...t,e])},z=(e,t)=>{Z(e),A(e=>e.slice(0,t+1))},V=async()=>{if(!T.trim()){b.ZP.error("Please enter a folder name");return}M(!0);try{let e=await fetch("/api/upload/folders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderName:T.trim(),parentPath:"root"===w?void 0:w})});if(e.ok)I(""),H(!1),b.ZP.success("Folder created successfully"),U();else{let t=await e.json();b.ZP.error(t.error||"Failed to create folder")}}catch(e){console.error("Error creating folder:",e),b.ZP.error("Failed to create folder")}finally{M(!1)}},_=async(e,t)=>{t.stopPropagation();let r=e.name;if(confirm('⚠️ Delete folder "'.concat(r,'"?\n\nThis will delete the folder and ALL contents including:\n- All images in this folder\n- All subfolders and their contents\n\nThis action cannot be undone.\n\nClick OK to confirm deletion.'))){M(!0),console.log("Deleting folder:",e.fullPath);try{let t=await fetch("/api/upload/folders?path=".concat(encodeURIComponent(e.fullPath)),{method:"DELETE"});if(console.log("Delete response status:",t.status),t.ok){let e=await t.json();console.log("Delete result:",e),b.ZP.success('Folder "'.concat(r,'" deleted successfully')),U()}else{let e=await t.json();console.error("Delete error response:",e),b.ZP.error(e.error||"Failed to delete folder")}}catch(e){console.error("Error deleting folder:",e),b.ZP.error("Network error: Failed to delete folder")}finally{M(!1)}}},q=async(e,a)=>{a.stopPropagation();let l=e.split("/").pop()||"image";if(confirm('⚠️ Delete image "'.concat(l,'"?\n\nThis action cannot be undone.\n\nClick OK to confirm deletion.'))){M(!0);try{let a=await fetch("/api/upload/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e})});if(a.ok)t.includes(e)&&r(t.filter(t=>t!==e)),b.ZP.success("Image deleted successfully"),U();else{let e=await a.json();b.ZP.error(e.error||"Failed to delete image")}}catch(e){console.error("Error deleting image:",e),b.ZP.error("Failed to delete image")}finally{M(!1)}}},K=async e=>{if(!e)return;let a=Array.from(e).filter(e=>e.type.startsWith("image/")&&e.size<=5242880);if(0===a.length){b.ZP.error("Please select valid image files (less than 5MB)");return}if(!j&&a.length>1){b.ZP.error("Please select only one image");return}if(j&&t.length+a.length>v){b.ZP.error("Maximum ".concat(v," images allowed"));return}S(!0);try{let e=a.map(async e=>{let t=new FormData;t.append("file",e),t.append("folder",w);let r=await fetch("/api/upload",{method:"POST",body:t});if(!r.ok)throw Error("Upload failed");return(await r.json()).url}),l=await Promise.all(e);j?r([...t,...l]):r(l);let s="root"===w?"root folder":w;b.ZP.success("Successfully uploaded ".concat(l.length," image(s) to ").concat(s)),U()}catch(e){console.error("Error uploading images:",e),b.ZP.error("Error occurred while uploading images")}finally{S(!1)}},J=e=>{if(j){if(t.includes(e))r(t.filter(t=>t!==e));else{if(t.length>=v){b.ZP.error("Maximum ".concat(v," images allowed"));return}r([...t,e])}}else r([e])},W=()=>R.map((e,t)=>({name:"root"===e?"Home":e.split("/").pop()||e,path:e,index:t}));return(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,a.jsx)(s.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"\uD83D\uDCC1 ",N," Explorer"]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("button",{type:"button",onClick:()=>U(),disabled:E,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg transition-colors",title:"Refresh",children:(0,a.jsx)(o.Z,{className:"h-4 w-4 ".concat(E?"animate-spin":"")})})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{if(R.length>1){let e=[...R];e.pop();let t=e[e.length-1];A(e),Z(t)}},disabled:R.length<=1,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Back",children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})}),(0,a.jsx)("div",{className:"flex items-center space-x-1 bg-white rounded-lg px-3 py-2 border flex-1",children:W().map((e,t)=>(0,a.jsxs)(l.Fragment,{children:[t>0&&(0,a.jsx)(i.Z,{className:"h-3 w-3 text-gray-400"}),(0,a.jsx)("button",{type:"button",onClick:()=>z(e.path,e.index),className:"text-sm px-2 py-1 rounded hover:bg-gray-100 transition-colors ".concat(t===W().length-1?"text-blue-600 font-medium":"text-gray-600 hover:text-gray-800"),children:0===t?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),e.name]}):e.name})]},e.path))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>H(!0),disabled:E,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm disabled:opacity-50",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"New Folder"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},disabled:F,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm disabled:opacity-50",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-1"}),F?"Uploading...":"Upload Images"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["\uD83D\uDCC2 ","root"===w?"Root Folder":w," •",k.length," folder(s) • ",P.length," image(s)"]})]}),L&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-white rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:T,onChange:e=>I(e.target.value),placeholder:"Enter folder name...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",onKeyPress:e=>"Enter"===e.key&&V(),autoFocus:!0}),(0,a.jsx)("button",{type:"button",onClick:V,disabled:E||!T.trim(),className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{type:"button",onClick:()=>{H(!1),I("")},className:"px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:["\uD83D\uDCA1 Creating folder in: ","root"===w?"Root":w]})]})]}),(0,a.jsx)("div",{className:"p-4",children:E?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x.Z,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Loading folder contents..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[k.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2 text-blue-500"}),"\uD83D\uDCC1 Folders (",k.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-3",children:k.map(e=>(0,a.jsxs)("div",{className:"group relative bg-gray-50 hover:bg-blue-50 rounded-lg p-3 cursor-pointer transition-colors border border-gray-200 hover:border-blue-300",children:[(0,a.jsxs)("div",{onClick:()=>B(e.fullPath),className:"text-center",children:[(0,a.jsx)(p.Z,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"supabase"===e.source?"☁️ Cloud":"\uD83D\uDCBB Local"})]}),(0,a.jsx)("button",{type:"button",onClick:t=>_(e,t),className:"absolute top-2 right-2 p-2 bg-red-500 text-white hover:bg-red-600 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-lg hover:shadow-xl",title:"Delete folder",disabled:E,children:(0,a.jsx)(g.Z,{className:"h-4 w-4"})})]},e.fullPath))})]}),P.length>0?(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2 text-green-500"}),"\uD83D\uDDBC️ Images (",P.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:P.map((e,r)=>{let l=t.includes(e);return(0,a.jsxs)("div",{onClick:()=>J(e),className:"relative group cursor-pointer rounded-lg overflow-hidden border-2 transition-all duration-200 ".concat(l?"border-green-500 ring-2 ring-green-200 shadow-lg":"border-gray-200 hover:border-blue-500 hover:shadow-md"),children:[(0,a.jsxs)("div",{className:"aspect-square relative bg-gray-100",children:[(0,a.jsx)(y.default,{src:e,alt:"Image ".concat(r+1),fill:!0,className:"object-cover"}),l&&(0,a.jsx)("div",{className:"absolute inset-0 bg-green-500 bg-opacity-20 flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-green-500 text-white rounded-full p-1",children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,a.jsx)("button",{type:"button",onClick:t=>q(e,t),className:"absolute top-2 right-2 p-2 bg-red-500 text-white hover:bg-red-600 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-lg hover:shadow-xl",title:"Delete image",disabled:E,children:(0,a.jsx)(g.Z,{className:"h-3 w-3"})})]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 text-white p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)("p",{className:"text-xs truncate",children:e.split("/").pop()})})]},r)})})]}):0===k.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(s.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-2",children:"This folder is empty"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Create folders or upload images to get started"})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(f.Z,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No images in this folder"})]})]})}),t.length>0&&(0,a.jsx)("div",{className:"border-t bg-gray-50 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 text-green-600 mr-2"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[t.length," image(s) selected"]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>r([]),className:"text-sm text-red-600 hover:text-red-800 underline",children:"Clear Selection"})]})}),(0,a.jsx)("input",{ref:O,type:"file",accept:"image/*",multiple:j,onChange:e=>K(e.target.files),className:"hidden"})]})}},32660:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},30401:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},10407:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},56475:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},14924:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]])},99637:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},53113:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},15863:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99397:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},82431:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},18930:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},17689:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},32489:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);